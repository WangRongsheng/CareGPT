# openai 3.5å¾®è°ƒå®æˆ˜

ğŸ‰ **OpenAI GPT-3.5 Turbo å¾®è°ƒåŠŸèƒ½å‘å¸ƒï¼**

OpenAI åˆšåˆšä¸º GPT-3.5 Turbo æ¨å‡ºäº†ä¸€é¡¹é©å‘½æ€§çš„å¾®è°ƒåŠŸèƒ½ï¼GPT-4 çš„å¾®è°ƒå°†äºä»Šå¹´ç§‹å¤©æ¨å‡ºã€‚ä»¥ä¸‹æ˜¯è¿™é¡¹æŠ€æœ¯çš„å…³é”®ä¿¡æ¯å’Œç‰¹è‰²ï¼š

### å¾®è°ƒåŠŸèƒ½ç®€ä»‹

1. **ä¸ªæ€§åŒ–è®­ç»ƒ**ï¼šå¾®è°ƒå…è®¸å¼€å‘è€…æ ¹æ®è‡ªå·±çš„æ•°æ®è®­ç»ƒæ¨¡å‹ï¼Œå¹¶åœ¨å¤§è§„æ¨¡ä¸‹è¿è¡Œã€‚
2. **å“è¶Šæ€§èƒ½**ï¼šæ—©æœŸæµ‹è¯•æ˜¾ç¤ºï¼Œå¾®è°ƒåçš„ GPT-3.5 Turbo å¯ä»¥åœ¨ç‰¹å®šä»»åŠ¡ä¸Šä¸ GPT-4 ç›¸åŒ¹æ•Œç”šè‡³è¶…è¶Šã€‚
3. **éšç§ä¿éšœ**: ä»å¾®è°ƒAPIå‘é€çš„æ•°æ®å½’å®¢æˆ·æ‰€æœ‰ï¼ŒOpenAIæˆ–ä»»ä½•å…¶ä»–ç»„ç»‡éƒ½ä¸ä¼šä½¿ç”¨å®ƒæ¥è®­ç»ƒå…¶ä»–æ¨¡å‹ã€‚

### å¾®è°ƒçš„ä¼˜åŠ¿

1. **å®šåˆ¶ä½“éªŒ**ï¼šæ¯ä¸ªä¸šåŠ¡å’Œåº”ç”¨éƒ½æœ‰ç‰¹å®šéœ€æ±‚ï¼Œå¾®è°ƒç¡®ä¿å¼€å‘è€…èƒ½è°ƒæ•´ GPT è¾“å‡ºï¼Œæä¾›çœŸæ­£å·®å¼‚åŒ–çš„ä½“éªŒã€‚ä¾‹å¦‚ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨å¾®è°ƒæ¥ç¡®ä¿æ¨¡å‹åœ¨æç¤ºä½¿ç”¨è¯¥è¯­è¨€æ—¶å§‹ç»ˆä»¥å¾·è¯­å“åº”ã€‚
2. **æˆæœ¬æ•ˆç›Š**ï¼šæœ‰å¯èƒ½å‡å°‘é«˜è¾¾ 90% çš„æç¤ºå¤§å°ï¼Œä¼ä¸šå¯ä»¥æ›´å¿«é€Ÿã€æ›´ç»æµåœ°è¿›è¡Œ API è°ƒç”¨ã€‚
3. **æ‰©å±•èƒ½åŠ›**ï¼šæ–°æ¨¡å‹æœ€å¤šå¯ä»¥å¤„ç† 4K ä»£å¸ï¼Œå¯¹å¤„ç†å¤§æ•°æ®é›†çš„å¼€å‘è€…æœ‰åˆ©ã€‚
4. **å¯é çš„è¾“å‡ºæ ¼å¼**ï¼šå¾®è°ƒå¯æé«˜æ¨¡å‹ä¸€è‡´æ ¼å¼åŒ–å“åº”çš„èƒ½åŠ›ï¼Œè¿™å¯¹äºéœ€è¦ç‰¹å®šå“åº”æ ¼å¼çš„åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ä»£ç å®Œæˆæˆ–æ’°å†™ API è°ƒç”¨ï¼‰æ¥è¯´è‡³å…³é‡è¦ã€‚å¼€å‘äººå‘˜å¯ä»¥ä½¿ç”¨å¾®è°ƒæ¥æ›´å¯é åœ°å°†ç”¨æˆ·æç¤ºè½¬æ¢ä¸ºå¯ä¸è‡ªå·±çš„ç³»ç»Ÿä¸€èµ·ä½¿ç”¨çš„é«˜è´¨é‡ JSON ä»£ç æ®µã€‚

### å¾®è°ƒæˆæœ¬

- **è®­ç»ƒ**ï¼šæ¯ 1K token $0.008
- **ä½¿ç”¨è¾“å…¥**ï¼šæ¯ 1K token $0.012
- **ä½¿ç”¨è¾“å‡º**ï¼šæ¯ 1K token $0.016

ä¾‹å¦‚ï¼Œ100,000 ä»£å¸çš„ gpt-3.5-turbo å¾®è°ƒå·¥ä½œï¼Œè®­ç»ƒ 3 ä¸ªå‘¨æœŸçš„é¢„æœŸæˆæœ¬ä¸º $2.40ã€‚

### ****å¾®è°ƒæ­¥éª¤****

- Step1 å‡†å¤‡æ•°æ®

```jsx
{
  "messages": [
    { "role": "system", "content": "You are an assistant that occasionally misspells words" },
    { "role": "user", "content": "Tell me a story." },
    { "role": "assistant", "content": "One day a student went to schoool." }
  ]
}
```

- Step2 ä¸Šä¼ æ–‡ä»¶

```jsx
curl -https://api.openai.com/v1/files \
  -H "Authorization: Bearer $OPENAI_API_KEY" \
  -F "purpose=fine-tune" \
  -F "file=@path_to_your_file"
```

- Step 3 å¼€å§‹å¾®è°ƒ

```jsx
curl https://api.openai.com/v1/fine_tuning/jobs \
-H "Content-Type: application/json" \
-H "Authorization: Bearer $OPENAI_API_KEY" \
-d '{
  "training_file": "TRAINING_FILE_ID",
  "model": "gpt-3.5-turbo-0613",
}'
```

- step4 ç›´æ¥ä½¿ç”¨

```jsx
curl https://api.openai.com/v1/chat/completions \
-H "Content-Type: application/json" \
-H "Authorization: Bearer $OPENAI_API_KEY" \
-d '{
  "model": "ft:gpt-3.5-turbo:org_id",
  "messages": [
    {
      "role": "system",
      "content": "You are an assistant that occasionally misspells words"
    },
    {
      "role": "user",
      "content": "Hello! What is fine-tuning?"
    }
  ]
}'
```

### å¾®è°ƒä¸­æ–‡åŒ»ç–—ç‰ˆGPT 3.5

- æ•°æ®æ¥æº

Huatuo-26M æ•°æ®é›†æ˜¯ç”±å¤šä¸ªæ¥æºæ”¶é›†å’Œæ•´åˆè€Œæˆï¼Œä¸»è¦åŒ…æ‹¬ï¼š

- åœ¨çº¿åŒ»ç–—ç™¾ç§‘
- åŒ»ç–—çŸ¥è¯†å›¾è°±
- ç½‘ç»œä¸Šçš„å…¬å¼€åŒ»ç–—é—®ç­”è®ºå›ï¼ˆç­”æ¡ˆä¸ºurlå½¢å¼ï¼‰

æ•°æ®é›†ä¸­çš„æ¯ä¸ªé—®ç­”å¯¹åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

- Questionï¼šé—®é¢˜æè¿°
- Answerï¼šåŒ»ç”Ÿ/ä¸“å®¶çš„ç­”æ¡ˆ

ä»¥ä¸‹ä¸ºæˆ‘ä»¬åœ¨è®ºæ–‡ä¸­ä½¿ç”¨çš„huatuoæµ‹è¯•é›†ï¼Œç”±å¤šä¸ªæ¥æºä¸­æ•°æ®éšæœºæŠ½å–ç»„æˆã€‚

- Testdatasetsï¼š[huatuo26M-testdatasets](https://huggingface.co/datasets/FreedomIntelligence/huatuo26M-testdatasets)

å®˜æ–¹æ¨èçš„æ˜¯æ•°é‡ä»…ä»…éœ€æ±‚**50-100**ä¸ªæ•°é‡ï¼è¿™é‡Œæˆ‘éšæœºæŠ½å–äº†Testdatasetsé‡Œé¢100ä¸ªæ•°æ®

```jsx
import json
import random

def transform_jsonl(input_file_path, output_file_path):
    entries = []
    with open(input_file_path, 'r') as file:
        for line in file:
            entry = json.loads(line)
            entries.append(entry)

    # éšæœºæŠ½å–100ä¸ªæ¡ç›®
    sampled_entries = random.sample(entries, 100)

    with open(output_file_path, 'w') as outfile:
        for entry in sampled_entries:
            messages = []
            messages.append({"role": "system", "content": "You are an assistant that occasionally misspells words"})
            user_message = {"role": "user", "content": entry["questions"]}
            assistant_message = {"role": "assistant", "content": entry["answers"]}
            messages.extend([user_message, assistant_message])
            result = {"messages": messages}
            json.dump(result, outfile, ensure_ascii=False)
            outfile.write('\n')

input_file_path = '' # è¯·æ›¿æ¢ä¸ºæ‚¨çš„è¾“å…¥JSONLæ–‡ä»¶è·¯å¾„
output_file_path = '' # è¯·æ›¿æ¢ä¸ºæ‚¨æƒ³è¦ä¿å­˜çš„è¾“å‡ºJSONLæ–‡ä»¶è·¯å¾„
transform_jsonl(input_file_path, output_file_path)
```

- ä¸Šä¼ æ–‡ä»¶ã€Œè¿™é‡Œæˆ‘ä¹Ÿè½¬æˆäº†pythonæ–‡ä»¶ï¼Œæ–¹ä¾¿å¤§å®¶ä½¿ç”¨ã€

```jsx
import requests
import openai

url = "https://api.openai.com/v1/files"
headers = {
    "Authorization": "Bearer $OPENAI_API_KEY"
}
payload = {
    "purpose": "fine-tune",
}
files = {
    "file": open("ä¸Šä¸€æ­¥è¾“å‡ºæ–‡ä»¶çš„è·¯å¾„", "rb")
}

response = requests.post(url, headers=headers, data=payload, files=files)
print(response)
print(openai.File.list())
```

è¾“å‡º**<Response [200]>ä»£è¡¨æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼ŒåŒæ—¶ä¹Ÿä¼šè¾“å‡ºæ–‡ä»¶çš„ID**

```jsx
{
      "object": "file",
      "id": "file-XXXXXXXXXXX",
      "purpose": "fine-tune",
      "filename": "output.jsonl",
      "bytes": 70137,
      "created_at": 1692763379,
      "status": "processed",
      "status_details": null
 }
```

- è¿›è¡Œå¾®è°ƒ

```jsx
import requests

url = "https://api.openai.com/v1/fine_tuning/jobs"
headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer $OPENAI_API_KEY"
}
data = {
    "training_file": "file-XXXXXXXXXXX",
    "model": "gpt-3.5-turbo-0613"
}

response = requests.post(url, headers=headers, json=data)
print(response.text)
```

å¾®è°ƒå®Œæˆä¹‹åä¼šè‡ªåŠ¨å‘é€åˆ°ä½ è´¦æˆ·çš„é‚®ç®±ğŸ“®

- æ¨¡å‹ä½¿ç”¨

```jsx
import requests

url = "https://api.openai.com/v1/chat/completions"
headers = {
    "Content-Type": "application/json",
    "Authorization": "Bearer $OPENAI_API_KEY"
}
data = {
    "model": "ft:gpt-3.5-turbo-0613:xxxxxxxx",
    "messages": [
        {
            "role": "system",
            "content": "You are an assistant that occasionally misspells words"
        },
        {
            "role": "user",
            "content": "æˆ‘åœ¨ä½“æ£€æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å»çŒ®è¡€åŒ»ç”Ÿæœ€æ˜¯è¯´æˆ‘çš„è¡€å‹é«˜ï¼Œä¸èƒ½çŒ®ã€‚è¡€å‹æ˜¯130ã€80è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ"
        }
    ]
}

response = requests.post(url, headers=headers, json=data)
print(response.text)
```

- æ•ˆæœå¯¹æ¯”

| ç”¨æˆ·è¾“å…¥ | gpt-3.5-turbo-0613 | ä»…ç”¨100æ¡æ•°æ®å¾®è°ƒå |
| --- | --- | --- |
| æˆ‘åœ¨ä½“æ£€æ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯å»çŒ®è¡€åŒ»ç”Ÿæœ€æ˜¯è¯´æˆ‘çš„è¡€å‹é«˜ï¼Œä¸èƒ½çŒ®ã€‚è¡€å‹æ˜¯130ã€80è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ | è¡€å‹130/80æ˜¯æ­£å¸¸è¡€å‹ï¼Œä½†æ˜¯çŒ®è¡€çš„æ ‡å‡†è¦æ±‚è¡€å‹ä½äº120/80ï¼Œæ‰€ä»¥æ‚¨çš„è¡€å‹è¶…å‡ºäº†çŒ®è¡€çš„æ ‡å‡†ï¼Œä¸èƒ½çŒ®è¡€ã€‚ | é¦–æ¬¡å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨çŒ®è¡€çš„æ—¶å€™ï¼Œä¼šå‡ºç°ç”Ÿç†æ€§çš„å…´å¥‹ï¼Œåå°„æ€§çš„å¼•èµ·è¡€å‹å‡é«˜ã€‚ä¸€èˆ¬æƒ…å†µä¸‹å°äº140ã€90mmHgï¼Œæ˜¯å…è®¸çŒ®è¡€çš„ã€‚å¯¹äºä¸€äº›æŒç»­æ€§çš„è¡€å‹å‡é«˜çš„å°±éœ€è¦ç§¯æçš„è°ƒç†äº†ã€‚ |

å¾®è°ƒè¿‡åæˆ‘ä»¬ä¸éœ€è¦å†™promptä¹Ÿèƒ½å¤Ÿè®©gpt-3.5-turbo-0613æœ‰æ›´åŠ ä¸“ä¸šçš„å›å¤ï¼

### å…³é”®é—®é¢˜ä¸è€ƒè™‘

- **æˆæœ¬é—®é¢˜**ï¼šå¾®è°ƒè™½ä¾¿å®œï¼Œæ¨¡å‹å¯èƒ½äº§ç”Ÿ 6-8 å€çš„ GPT3.5 å¸¸è§„è´¹ç”¨ã€‚
- **æŠ•èµ„ä¸å›æŠ¥**ï¼šäººä»¬æ˜¯å¦æ„¿æ„æŠ•å…¥æ›´å¤šèµ„é‡‘å¾®è°ƒæ¨¡å‹ï¼Œè€Œä¸ä»…æ˜¯è¿›è¡Œæ›´å¥½çš„æç¤ºæˆ–é“¾æ¥ï¼Ÿ

### å³å°†åˆ°æ¥

- **æ–°å¾®è°ƒä»ªè¡¨æ¿**
- **æ›´å¤šç”¨æˆ·å‹å¥½å·¥å…·**

å¾®è°ƒåŠŸèƒ½æ— ç–‘å°†ä¸º AI é¢†åŸŸå¸¦æ¥æ–°çš„å¯èƒ½æ€§å’ŒæŒ‘æˆ˜ã€‚ä¼ä¸šå’Œå¼€å‘è€…å¯ä»¥æœŸå¾…æ›´å¤šå®šåˆ¶åŒ–å’Œé«˜æ•ˆçš„è§£å†³æ–¹æ¡ˆã€‚ğŸš€